<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register - Mentor-Mentee Platform</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="auth-container">
        <div class="auth-card register-card">
            <div class="auth-header">
                <h2 id="registerTitle">Create Your Account</h2>
                <p id="registerSubtitle">Join our community of learners and teachers</p>
            </div>
            
            <form id="registerForm" class="auth-form register-form">
                <!-- Basic Information -->
                <div class="form-section">
                    <h3>Personal Information</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="firstName">First Name *</label>
                            <input type="text" id="firstName" name="firstName" required>
                        </div>
                        <div class="form-group">
                            <label for="lastName">Last Name *</label>
                            <input type="text" id="lastName" name="lastName" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="age">Age *</label>
                            <input type="number" id="age" name="age" min="18" max="100" required>
                        </div>
                        <div class="form-group">
                            <label for="gender">Gender</label>
                            <select id="gender" name="gender">
                                <option value="">Prefer not to say</option>
                                <option value="male">Male</option>
                                <option value="female">Female</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="email">Email Address *</label>
                        <input type="email" id="email" name="email" required>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="password">Password *</label>
                            <input type="password" id="password" name="password" required minlength="6">
                        </div>
                        <div class="form-group">
                            <label for="confirmPassword">Confirm Password *</label>
                            <input type="password" id="confirmPassword" name="confirmPassword" required>
                        </div>
                    </div>
                </div>
                
                <!-- Contact Information -->
                <div class="form-section">
                    <h3>Contact Information</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="mobileNumber">Mobile Number *</label>
                            <input type="tel" id="mobileNumber" name="mobileNumber" required>
                        </div>
                        <div class="form-group">
                            <label for="upiId">UPI ID *</label>
                            <input type="text" id="upiId" name="upiId" placeholder="example@upi" required>
                        </div>
                    </div>
                </div>
                
                <!-- Education Information -->
                <div class="form-section">
                    <h3>Education & Background</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="education">Education Level *</label>
                            <select id="education" name="education" required>
                                <option value="">Select Education Level</option>
                                <option value="high-school">High School</option>
                                <option value="undergraduate">Undergraduate</option>
                                <option value="graduate">Graduate</option>
                                <option value="postgraduate">Postgraduate</option>
                                <option value="phd">PhD</option>
                                <option value="professional">Professional Certification</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="institution">Institution *</label>
                            <input type="text" id="institution" name="institution" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="currentPursuit">What are you currently pursuing? *</label>
                        <input type="text" id="currentPursuit" name="currentPursuit" required>
                    </div>
                </div>
                
                <!-- Languages -->
                <div class="form-section">
                    <h3>Languages</h3>
                    <div class="form-group">
                        <label>Languages you can communicate in *</label>
                        <div class="checkbox-group" id="languagesGroup">
                            <label><input type="checkbox" name="languages" value="English"> English</label>
                            <label><input type="checkbox" name="languages" value="Hindi"> Hindi</label>
                            <label><input type="checkbox" name="languages" value="Spanish"> Spanish</label>
                            <label><input type="checkbox" name="languages" value="French"> French</label>
                            <label><input type="checkbox" name="languages" value="German"> German</label>
                            <label><input type="checkbox" name="languages" value="Mandarin"> Mandarin</label>
                            <label><input type="checkbox" name="languages" value="Other"> Other</label>
                        </div>
                    </div>
                </div>
                
                <!-- Availability -->
                <div class="form-section">
                    <h3>Availability</h3>
                    <div class="form-group">
                        <label>What hours of the day are you available? *</label>
                        <div class="checkbox-group" id="availabilityGroup">
                            <label><input type="checkbox" name="availableHours" value="Early Morning (6-9 AM)"> Early Morning (6-9 AM)</label>
                            <label><input type="checkbox" name="availableHours" value="Morning (9-12 PM)"> Morning (9-12 PM)</label>
                            <label><input type="checkbox" name="availableHours" value="Afternoon (12-4 PM)"> Afternoon (12-4 PM)</label>
                            <label><input type="checkbox" name="availableHours" value="Evening (4-8 PM)"> Evening (4-8 PM)</label>
                            <label><input type="checkbox" name="availableHours" value="Night (8-11 PM)"> Night (8-11 PM)</label>
                            <label><input type="checkbox" name="availableHours" value="Late Night (11 PM-6 AM)"> Late Night (11 PM-6 AM)</label>
                        </div>
                    </div>
                </div>
                
                <!-- Mentor Specific Fields -->
                <div class="form-section" id="mentorFields" style="display: none;">
                    <h3>Mentor Information</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="hourlyRate">Hourly Rate (₹) *</label>
                            <input type="number" id="hourlyRate" name="hourlyRate" min="100" step="50">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="subjects">Subjects you can mentor in *</label>
                        <textarea id="subjects" name="subjects" rows="3" placeholder="e.g., Mathematics, Programming, Business, etc. (comma-separated)"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="qualifications">Your qualifications and experience</label>
                        <textarea id="qualifications" name="qualifications" rows="4" placeholder="Describe your qualifications, experience, and what makes you a great mentor"></textarea>
                    </div>
                </div>
                
                <!-- Mentee Specific Fields -->
                <div class="form-section" id="menteeFields" style="display: none;">
                    <h3>Mentee Information</h3>
                    <div class="form-group">
                        <label for="interests">Subjects you want to learn *</label>
                        <textarea id="interests" name="interests" rows="3" placeholder="e.g., Programming, Data Science, Marketing, etc. (comma-separated)"></textarea>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="budgetMin">Minimum Budget (₹/hour)</label>
                            <input type="number" id="budgetMin" name="budgetMin" min="100" step="50">
                        </div>
                        <div class="form-group">
                            <label for="budgetMax">Maximum Budget (₹/hour)</label>
                            <input type="number" id="budgetMax" name="budgetMax" min="100" step="50">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="preferredMentorGender">Preferred Mentor Gender</label>
                        <select id="preferredMentorGender" name="preferredMentorGender">
                            <option value="">No preference</option>
                            <option value="male">Male</option>
                            <option value="female">Female</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                </div>
                
                <div class="payment-notice">
                    <h3>Payment Information</h3>
                    <p><strong>Important:</strong> After each session, payment must be made to our platform UPI ID first. We charge a 10% commission and transfer the remaining amount to your mentor after the session is completed.</p>
                    <p><strong>Platform UPI ID:</strong> <code>platform@upi</code></p>
                </div>
                
                <button type="submit" class="btn btn-primary">Create Account</button>
            </form>
            
            
            <div class="auth-footer">
                <p>Already have an account? <a href="/login">Sign in here</a></p>
                <p><a href="/">← Back to Home</a></p>
            </div>
        </div>
    </div>

    <div id="errorMessage" class="error-message" style="display: none;"></div>
    <div id="successMessage" class="success-message" style="display: none;"></div>

    <script>
        // Show/hide fields based on user type
        const userType = localStorage.getItem('selectedUserType') || 'mentee';
        document.getElementById('registerTitle').textContent = `Create Your ${userType.charAt(0).toUpperCase() + userType.slice(1)} Account`;
        
        if (userType === 'mentor') {
            document.getElementById('mentorFields').style.display = 'block';
            document.getElementById('hourlyRate').required = true;
            document.getElementById('subjects').required = true;
        } else {
            document.getElementById('menteeFields').style.display = 'block';
            document.getElementById('interests').required = true;
        }
        
        // Handle form submission
        document.getElementById('registerForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            
            // Validate password confirmation
            if (formData.get('password') !== formData.get('confirmPassword')) {
                showMessage('Passwords do not match', 'error');
                return;
            }
            
            // Collect checkbox values
            const languages = Array.from(document.querySelectorAll('input[name="languages"]:checked')).map(el => el.value);
            const availableHours = Array.from(document.querySelectorAll('input[name="availableHours"]:checked')).map(el => el.value);
            
            if (languages.length === 0) {
                showMessage('Please select at least one language', 'error');
                return;
            }
            
            if (availableHours.length === 0) {
                showMessage('Please select your availability', 'error');
                return;
            }
            
            const registrationData = {
                userType: userType,
                firstName: formData.get('firstName'),
                lastName: formData.get('lastName'),
                age: parseInt(formData.get('age')),
                gender: formData.get('gender'),
                email: formData.get('email'),
                password: formData.get('password'),
                mobileNumber: formData.get('mobileNumber'),
                upiId: formData.get('upiId'),
                education: formData.get('education'),
                institution: formData.get('institution'),
                currentPursuit: formData.get('currentPursuit'),
                languages: languages,
                availableHours: availableHours
            };
            
            if (userType === 'mentor') {
                registrationData.hourlyRate = parseFloat(formData.get('hourlyRate'));
                registrationData.subjects = formData.get('subjects').split(',').map(s => s.trim());
                registrationData.qualifications = formData.get('qualifications');
            } else {
                registrationData.interests = formData.get('interests').split(',').map(s => s.trim());
                registrationData.budgetMin = formData.get('budgetMin') ? parseFloat(formData.get('budgetMin')) : null;
                registrationData.budgetMax = formData.get('budgetMax') ? parseFloat(formData.get('budgetMax')) : null;
                registrationData.preferredMentorGender = formData.get('preferredMentorGender');
            }
            
            try {
                const response = await fetch('/api/register', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(registrationData)
                });
                
                const result = await response.json();
                
                if (response.ok) {
                    showMessage('Registration successful! Please sign in with your credentials.', 'success');
                    setTimeout(() => {
                        window.location.href = '/login';
                    }, 2000);
                } else {
                    showMessage(result.message || 'Registration failed', 'error');
                }
            } catch (error) {
                showMessage('An error occurred. Please try again.', 'error');
            }
        });
        
        
        function showMessage(message, type) {
            const messageEl = document.getElementById(type === 'error' ? 'errorMessage' : 'successMessage');
            messageEl.textContent = message;
            messageEl.style.display = 'block';
            
            setTimeout(() => {
                messageEl.style.display = 'none';
            }, 5000);
        }
    </script>
</body>
</html>
