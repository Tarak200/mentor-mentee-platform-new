<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mentee Dashboard - Find Your Perfect Mentor</title>
    <link rel="stylesheet" href="/components/shared/shared.css?v=20250921">
    <link rel="stylesheet" href="/components/mentee/dashboard/mentee-dashboard.css?v=20250921">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body class="mentee-body">
    <div class="mentee-dashboard">
        <!-- Top Navigation Bar -->
        <header class="mentee-header">
            <div class="logo-section">
                <i class="fas fa-graduation-cap"></i>
                <h2>MenteePlatform</h2>
            </div>
            
            <div class="header-center">
                <div class="welcome-message">
                    <h3>Welcome back, <span id="userName">Loading...</span>! ðŸ‘‹</h3>
                    <p>Ready to learn something new today?</p>
                </div>
            </div>
            
            <div class="header-right">
                <div class="user-profile">
                    <img id="profilePic" class="profile-avatar" src="/uploads/default-avatar.png" alt="Profile">
                    <div class="profile-dropdown">
                        <button class="profile-btn" onclick="toggleProfileMenu()">
                            <span id="userNameShort">Me</span>
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div id="profileMenu" class="profile-menu">
                            <a href="#" onclick="showSection('profile')"><i class="fas fa-user"></i> Profile</a>
                            <a href="#" onclick="showCustomerCare()"><i class="fas fa-headset"></i> Customer Care</a>
                            <a href="#" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Logout</a>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="mentee-main">
            <!-- Quick Stats Bar -->
            <div class="stats-bar">
                <div class="stat-item">
                    <i class="fas fa-calendar-check"></i>
                    <div>
                        <span id="upcomingSessions">0</span>
                        <label>Upcoming Sessions</label>
                    </div>
                </div>
                <div class="stat-item">
                    <i class="fas fa-users"></i>
                    <div>
                        <span id="connectedMentors">0</span>
                        <label>Connected Mentors</label>
                    </div>
                </div>
                <div class="stat-item">
                    <i class="fas fa-star"></i>
                    <div>
                        <span id="completedSessions">0</span>
                        <label>Completed Sessions</label>
                    </div>
                </div>
                <div class="stat-item">
                    <i class="fas fa-wallet"></i>
                    <div>
                        <span id="totalSpent">â‚¹0</span>
                        <label>Total Spent</label>
                    </div>
                </div>
            </div>

            <!-- Navigation Tabs -->
            <div class="nav-tabs">
                <button class="tab-btn active" onclick="showSection('search'); this.parentElement.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active')); this.classList.add('active');">
                    <i class="fas fa-search"></i> Find Mentors
                </button>
                <button class="tab-btn" onclick="showSection('sessions'); this.parentElement.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active')); this.classList.add('active');">
                    <i class="fas fa-calendar"></i> My Sessions
                </button>
                <button class="tab-btn" onclick="showSection('profile'); this.parentElement.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active')); this.classList.add('active');">
                    <i class="fas fa-user"></i> My Profile
                </button>
            </div>

            <!-- Mentor Search Section -->
            <section id="searchSection" class="search-section">
                <div class="section-header">
                    <h2><i class="fas fa-search"></i> Find Your Perfect Mentor</h2>
                    <p>Discover expert mentors based on your learning needs</p>
                </div>
                
                <div class="search-filters">
                    <div class="search-row-1">
                        <div class="search-input-group">
                            <i class="fas fa-book"></i>
                            <input type="text" 
                                id="subjectSearch" 
                                placeholder="What subject do you want to learn? (e.g., Programming, Math, Business)">
                        </div>
                        <button onclick="searchMentors()" class="btn btn-search">
                            <i class="fas fa-search"></i> Search Mentors
                        </button>
                    </div>
                    
                    <div class="filter-section">
                        <h4><i class="fas fa-filter"></i> Filter Options</h4>
                        <div class="filter-grid">
                            <div class="filter-group">
                                <label><i class="fas fa-rupee-sign"></i> Price Range (per hour)</label>
                                <div class="price-inputs">
                                    <input type="number" 
                                        id="minPrice" 
                                        placeholder="Min â‚¹" 
                                        min="0">
                                    <span>to</span>
                                    <input type="number" 
                                        id="maxPrice" 
                                        placeholder="Max â‚¹" 
                                        min="0">
                                </div>
                            </div>
                            
                            <div class="filter-group">
                                <label><i class="fas fa-venus-mars"></i> Mentor Gender</label>
                                <select id="genderFilter">
                                    <option value="">Any Gender</option>
                                    <option value="male">Male</option>
                                    <option value="female">Female</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                            
                            <div class="filter-group">
                                <label><i class="fas fa-language"></i> Communication Language</label>
                                <input type="text" 
                                    id="languageSearch" 
                                    placeholder="e.g., English, Hindi">
                            </div>
                            
                            <div class="filter-group">
                                <button onclick="clearFilters()" class="btn btn-clear">
                                    <i class="fas fa-times"></i> Clear
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Mentors Grid -->
                <div class="mentors-section">
                    <div class="mentors-header">
                        <h3><i class="fas fa-chalkboard-teacher"></i> Available Mentors</h3>
                        <span id="mentorCount">Loading...</span>
                    </div>
                    <div id="mentorsGrid" class="mentors-grid">
                        <div class="loading-mentors">
                            <i class="fas fa-spinner fa-spin"></i>
                            <p>Finding the best mentors for you...</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- My Sessions Section -->
            <section id="sessionsSection" class="sessions-section" style="display: none;">
                <div class="section-header">
                    <h2><i class="fas fa-calendar"></i> My Learning Sessions</h2>
                    <p>Track your upcoming and completed sessions</p>
                </div>

            <div class="sessions-tabs">
                <button class="session-tab active" onclick="showSessionType('upcoming', event)">Upcoming</button>
                <button class="session-tab" onclick="showSessionType('completed', event)">Completed</button>
                <!-- render session tabs dynamically -->
            </div>

                <div id="sessionsList" class="sessions-list">
                    <div class="loading-sessions">
                        <i class="fas fa-spinner fa-spin"></i>
                        <p>Loading your sessions...</p>
                    </div>
                </div>
                
                <div class="payment-instructions">
                    <div class="payment-card">
                        <h3><i class="fas fa-credit-card"></i> Payment Instructions</h3>
                        <div class="payment-steps">
                            <div class="step">
                                <span class="step-number">1</span>
                                <div class="step-content">
                                    <h4>Pay to Platform First</h4>
                                    <p>After mentor accepts, pay full amount to our UPI ID</p>
                                </div>
                            </div>
                            <div class="step">
                                <span class="step-number">2</span>
                                <div class="step-content">
                                    <h4>Platform UPI ID</h4>
                                    <div class="upi-info">
                                        <code id="platformUpiId">platform@upi</code>
                                        <button onclick="copyUpiId()" class="copy-btn" title="Copy UPI ID">
                                            <i class="fas fa-copy"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="step">
                                <span class="step-number">3</span>
                                <div class="step-content">
                                    <h4>Commission & Transfer</h4>
                                    <p>We charge <span class="commission-percentage">10%</span> commission and transfer the rest to mentor</p>
                                </div>
                            </div>
                        </div>
                        <div class="payment-warning">
                            <i class="fas fa-exclamation-triangle"></i>
                            <p><strong>Mandatory:</strong> Payment must be completed before session starts. Unpaid sessions will be cancelled.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Profile Section -->
            <section id="profileSection" class="profile-section" style="display: none;">
                <div class="section-header">
                    <h2><i class="fas fa-user-circle"></i> My Profile</h2>
                    <p>Manage your learning profile and preferences</p>
                </div>

                <div class="profile-content">
                    <div class="profile-card">
                        <div class="profile-picture-section">
                            <img id="profilePicLarge" src="backend/uploads/default.jpg" alt="Profile Picture">
                            <div class="profile-upload">
                                <input type="file" id="profilePicUpload" accept="image/*" hidden>
                                <button onclick="document.getElementById('profilePicUpload').click()" class="btn btn-upload">
                                    <i class="fas fa-camera"></i> Change Picture
                                </button>
                            </div>
                        </div>
                        
                        <div id="profileDetails" class="profile-details">
                            <div class="loading-profile">
                                <i class="fas fa-spinner fa-spin"></i>
                                <p>Loading your profile...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Connection Request Modal -->
        <div id="connectModal" class="modal" style="display: none;">
            <div class="modal-overlay" onclick="closeConnectModal()"></div>
            <div class="modal-content connect-modal">
                <div class="modal-header">
                    <h3 id="connectModalTitle"><i class="fas fa-handshake"></i> Connect with Mentor</h3>
                    <button type="button" onclick="closeConnectModal()" class="close-btn"><i class="fas fa-times"></i></button>
                </div>
                
                <!-- Selected mentor preview -->
                <div class="mentor-preview" id="selectedMentorPreview"></div>
                
                <!-- Connection request form -->
                <form id="connectForm">
                    <div class="form-group">
                        <label for="subject"><i class="fas fa-book"></i> Subject</label>
                        <input type="text" id="subject" required placeholder="What do you want to learn?">
                    </div>
                    
                    <div class="form-group">
                        <label for="message"><i class="fas fa-comment"></i> Message to Mentor</label>
                        <textarea id="message" rows="4" placeholder="Tell the mentor about your learning goals..." required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="preferredTime"><i class="fas fa-clock"></i> Preferred Date & Time</label>
                        <input type="datetime-local" id="preferredTime" required>
                    </div>
                    
                    <div class="connection-note">
                        <i class="fas fa-info-circle"></i>
                        <p>Your request will be sent to the mentor. If accepted, you'll need to pay the session fee before the meeting starts.</p>
                    </div>
                    
                    <div class="modal-actions">
                        <button type="submit" class="btn btn-connect">
                            <i class="fas fa-paper-plane"></i> Send Request
                        </button>
                        <button type="button" onclick="closeConnectModal()" class="btn btn-cancel">
                            Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- ===== Mentor Profile Modal ===== -->
        <div id="mentorProfileModal" class="modal">
            <div class="modal-content">
                <span class="close-btn" onclick="closeMentorModal()">&times;</span>
                <div id="mentorProfileContent">
                    <!-- Mentor details will be inserted dynamically here -->
                </div>
            </div>
        </div>


        <!-- Mentor Profile Modal -->
        <!-- <div id="mentorProfileModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeModal('mentorProfileModal')">&times;</span>
                <h3>Mentor Profile</h3>
                <div id="mentorProfileContent"></div>
            </div>
        </div> -->

        <!-- Customer Care Modal -->
        <div id="customerCareModal" class="modal" style="display: none;">
            <div class="modal-overlay" onclick="closeCustomerCare()"></div>
            <div class="modal-content">
                <div class="modal-header">
                    <h3><i class="fas fa-headset"></i> Customer Care</h3>
                    <button onclick="closeCustomerCare()" class="close-btn"><i class="fas fa-times"></i></button>
                </div>
                <div class="customer-care-content">
                    <div class="contact-option">
                        <i class="fas fa-envelope"></i>
                        <div>
                            <h4>Email Support</h4>
                            <p>support@mentorplatform.com</p>
                        </div>
                    </div>
                    <div class="contact-option">
                        <i class="fas fa-phone"></i>
                        <div>
                            <h4>Phone Support</h4>
                            <p>+91-1800-123-4567 (Mon-Fri, 9 AM - 6 PM)</p>
                        </div>
                    </div>
                    <div class="contact-option">
                        <i class="fas fa-comments"></i>
                        <div>
                            <h4>Live Chat</h4>
                            <p>Available 24/7 for instant support</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Success Popup Modal -->
        <div id="successPopup" class="modal" style="display: none;">
            <div class="modal-overlay" onclick="closeSuccessPopup()"></div>
            <div class="modal-content success-popup">
                <div class="success-icon">
                    <i class="fas fa-check-circle" style="color: #10B981; font-size: 3rem;"></i>
                </div>
                <div class="success-content" style="text-align: center; padding: 20px;">
                    <h3 style="color: #10B981; margin: 10px 0;">Success!</h3>
                    <p id="successPopupMessage" style="margin: 15px 0; line-height: 1.5;"></p>
                    <button onclick="closeSuccessPopup()" class="btn btn-primary" style="margin-top: 20px;">OK</button>
                </div>
            </div>
        </div>
    </div>




    <div id="errorMessage" class="error-message" style="display: none;"></div>
    <div id="successMessage" class="success-message" style="display: none;"></div>

    <!-- Security Script -->
    <script src="/components/mentee/dashboard/mentee-dashboard-security.js"></script>

    <!-- Functionality Script -->
    <script src="/components/mentee/dashboard/mentee-dashboard.js"></script>
    
    <!-- Socket.IO client -->
    <script src="/socket.io/socket.io.js"></script>
</body>
</html>